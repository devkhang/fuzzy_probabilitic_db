name: .NET Framework CI

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:
    runs-on: windows-latest # 1. ĐỔI TỪ UBUNTU SANG WINDOWS

    steps:
    - uses: actions/checkout@v4

    # 2. Cài đặt MSBuild (Công cụ build cho .NET Framework cũ)
    - name: Setup MSBuild
      uses: microsoft/setup-msbuild@v2

    # 3. Cài đặt NuGet để tải thư viện
    - name: Setup NuGet
      uses: NuGet/setup-nuget@v2

    # 4. Restore bằng NuGet (Thay vì dotnet restore)
    - name: Restore dependencies
      run: nuget restore FPRDB/FPRDB.sln

    # 5. Build bằng MSBuild (Thay vì dotnet build)
    - name: Build
      run: msbuild FPRDB/FPRDB.sln /p:Configuration=Release

    # 6. Test
    # Lưu ý: Nếu project Test của bạn cũng là .NET Framework cũ, hãy dùng lệnh này:
    - name: Test
      run: |
        vstest.console.exe FPRDB\UnitTestProject1\bin\Release\UnitTestProject1.dll
      # Nếu lệnh trên lỗi, hãy thử tạm thời comment dòng Test lại để đảm bảo Build thành công trước.